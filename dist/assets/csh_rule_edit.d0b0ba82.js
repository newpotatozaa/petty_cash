import{d as w,aq as R,ar as A,as as U,e as v,H as p,C as E,at as N,_ as C,r as b,f as n,k as e,p as g,w as y,o as l,m as I,F as S,i as M,l as k,z as $}from"./index.845388b1.js";import{g as x}from"./assets.3726cf21.js";import{a as B}from"./account.9bb92812.js";import{M as V}from"./multiselect.f57e4c70.js";import{S as D}from"./sweetalert2.ad5735fd.js";import{c as F,a as q}from"./object.1d1a0185.js";const T=w({name:"user-account-profile",components:{ErrorMessage:R,Field:A,VForm:U,Multiselect:V},data(){return{menuData:[]}},async mounted(){const t=v();this.loadData(t.params.id)},methods:{async loadData(t){this.menuData=[];try{const s=await p.get(`http://localhost:3100/api/ListMenuById/${t}`);this.menuData=s.data}catch(s){console.error("Error fetching data:",s)}},async onSubmitSaveChanges(t,s){let c=!0,a="";v();const i=this.$route.params.id,m={UserRule_Name:t.UserRule_Name,UserRule_Delete:"0"};try{await p.put(`http://localhost:3100/api/updateUserRules/${i}`,m).then(r=>{a=r.data.message}).catch(r=>{console.error("An error occurred:",r),c=!1,a="An error occurred:"+r});const u=[];for(const r of this.menuData)for(const _ of r.MainMenu)for(const h of _.SubMenu){const d={UserRule_Id:i,MainMenu_Id:_.MainMenu_Id.toString(),SubMenu_Id:h.SubMenu_Id.toString(),UserRuleDetail_Delete:"0"};console.log(d);const f=p.delete(`http://localhost:3100/api/delUserRulesDetail/${i}
                                                                                        /${_.MainMenu_Id.toString()}
                                                                                        /${h.SubMenu_Id.toString()}`).then(()=>{}).catch(o=>{console.error("An error occurred:",o),c=!1,a="An error occurred: "+o});u.push(f),h.Active==!0&&u.push(p.post("http://localhost:3100/api/createUserRulesDetail",d).then(()=>{}).catch(o=>{console.error("An error occurred:",o),c=!1,a="An error occurred: "+o}))}await Promise.all(u),(c=!0)?D.fire({text:a,icon:"success",buttonsStyling:!1,confirmButtonText:"Ok, got it!",heightAuto:!1,customClass:{confirmButton:"btn fw-semobold btn-light-primary"}}).then(async()=>{await this.loadData(i)}):D.fire({text:"Error inserting data:"+a,icon:"error",buttonsStyling:!1,confirmButtonText:"Try again!",heightAuto:!1,customClass:{confirmButton:"btn fw-semobold btn-light-danger"}})}catch(u){console.error("Error inserting data:",u)}}},setup(){v(),B();const t=E({}),s=E({}),c=E(null),a=m=>{m.Active=!m.Active},i=F().shape({UserRule_Name:q().required().label("UserRule_Name")});return{toggleSubMenuActive:a,getAssetPath:x,submitButton:c,userDetail:i,myPrefix:s,nameTitle:t,Tooltip:N}}}),P={class:"card mb-5 mb-xl-10"},L=e("div",{class:"card-header border-0","data-bs-target":"#kt_account_profile","aria-expanded":"true","aria-controls":"kt_account_profile"},[e("div",{class:"card-title m-0"},[e("h3",{class:"fw-medium m-0"},"\u0E41\u0E01\u0E49\u0E44\u0E02\u0E15\u0E31\u0E49\u0E07\u0E04\u0E48\u0E32\u0E2A\u0E34\u0E17\u0E18\u0E34\u0E4C")])],-1),j={id:"kt_account_profile"},z={class:"card-body border-top p-9"},H={key:0,class:"row mb-6"},O=e("label",{class:"col-lg-4 col-form-label required fw-semobold fs-6"},"\u0E2A\u0E34\u0E17\u0E18\u0E34\u0E4C",-1),G={class:"col-lg-8 fv-row"},J={class:"fv-plugins-message-container"},K={class:"fv-help-block"},Q={class:"col-lg-4 col-form-label fw-semobold fs-6"},W={class:"col-lg-8 fv-row"},X=["name","checked","onChange"],Y={class:"col-lg-4 col-form-label fw-semobold fs-6"},Z={class:"card-footer d-flex justify-content-end py-6 px-9"},ee=e("button",{type:"reset",class:"btn btn-light btn-active-light-second me-2"}," Discard ",-1),te={type:"submit",id:"kt_account_profile_details_submit",ref:"submitButton",class:"btn btn-success"},oe=e("span",{class:"indicator-label"}," Save ",-1),se=e("span",{class:"indicator-progress"},[$(" Please wait... "),e("span",{class:"spinner-border spinner-border-sm align-middle ms-2"})],-1),ae=[oe,se];function re(t,s,c,a,i,m){const u=b("Field"),r=b("ErrorMessage"),_=b("router-link"),h=b("VForm");return l(),n("div",P,[L,e("div",j,[g(h,{id:"kt_account_profile_form",class:"form",novalidate:"",onSubmit:t.onSubmitSaveChanges,"validation-schema":t.userDetail},{default:y(()=>[e("div",z,[t.menuData.length>0?(l(),n("div",H,[O,e("div",G,[g(u,{type:"text",name:"UserRule_Name",class:"form-control form-control-lg form-control-solid",placeholder:"",modelValue:t.menuData[0].UserRule_Name,"onUpdate:modelValue":s[0]||(s[0]=d=>t.menuData[0].UserRule_Name=d)},null,8,["modelValue"]),e("div",J,[e("div",K,[g(r,{name:"UserRule_Name"})])])])])):I("",!0),(l(!0),n(S,null,M(t.menuData,d=>(l(),n("div",{key:d.UserRule_Name},[(l(!0),n(S,null,M(d.MainMenu,f=>(l(),n("div",{key:f.MainMenu_Id,class:"row mb-6"},[e("label",Q,k(f.MainMenu_Name),1),e("div",W,[(l(!0),n(S,null,M(f.SubMenu,o=>(l(),n("div",{key:o.SubMenu_Id,class:"form-check form-check-solid mt-2"},[e("input",{type:"checkbox",name:"status_"+o.SubMenu_Id,class:"form-check-input",checked:o.Active,onChange:ne=>t.toggleSubMenuActive(o)},null,40,X),e("label",Y,k(o.SubMenu_Name),1)]))),128))])]))),128))]))),128))]),e("div",Z,[g(_,{to:"/csh_rule_sea/index"},{default:y(()=>[ee]),_:1}),e("button",te,ae,512)])]),_:1},8,["onSubmit","validation-schema"])])])}const _e=C(T,[["render",re]]);export{_e as default};
