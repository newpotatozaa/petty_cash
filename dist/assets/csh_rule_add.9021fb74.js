import{d as D,aq as w,ar as R,as as A,H as b,e as v,C as g,G as x,at as C,_ as U,r as m,f as i,k as e,p as _,w as E,o as u,F as S,i as y,l as k,z as N}from"./index.845388b1.js";import{g as B}from"./assets.3726cf21.js";import{a as I}from"./account.9bb92812.js";import{M as F}from"./multiselect.f57e4c70.js";import{S as M}from"./sweetalert2.ad5735fd.js";import{c as q,a as $}from"./object.1d1a0185.js";const T=D({name:"user-account-profile",components:{ErrorMessage:w,Field:R,VForm:A,Multiselect:F},data(){return{menuData:[]}},async mounted(){try{const t=await b.get("http://localhost:3100/api/ListMenu");this.menuData=t.data,console.log(this.menuData)}catch(t){console.error("Error fetching data:",t)}},methods:{async onSubmitSaveChanges(t,h){let r=!0,n="";v();const f={UserRule_Name:t.UserRule_Name,UserRule_Delete:"0"};try{let o;await b.post("http://localhost:3100/api/createUserRules",f).then(s=>{o=s.data.userRule.UserRule_Id}).catch(s=>{console.error("An error occurred:",s),r=!1,n="An error occurred:"+s});const d=[];for(const s of this.menuData)for(const c of s.SubMenu)if(c.Active==!0){const p={UserRule_Id:o,MainMenu_Id:s.MainMenu_Id.toString(),SubMenu_Id:c.SubMenu_Id.toString(),UserRuleDetail_Delete:"0"},l=b.post("http://localhost:3100/api/createUserRulesDetail",p).then(()=>{}).catch(a=>{console.error("An error occurred:",a),r=!1,n="An error occurred: "+a});d.push(l)}await Promise.all(d),(r=!0)?M.fire({text:"Data inserted successfully!",icon:"success",buttonsStyling:!1,confirmButtonText:"Ok, got it!",heightAuto:!1,customClass:{confirmButton:"btn fw-semobold btn-light-primary"}}).then(()=>{this.$router.push("/csh_rule_sea/index")}):M.fire({text:"Error inserting data:"+n,icon:"error",buttonsStyling:!1,confirmButtonText:"Try again!",heightAuto:!1,customClass:{confirmButton:"btn fw-semobold btn-light-danger"}})}catch(o){console.error("Error inserting data:",o)}}},setup(){v(),I();const t=g({}),h=g({}),r=g(null),n=q().shape({UserRule_Name:$().required().label("UserRule_Name")});return x(async()=>{}),{getAssetPath:B,submitButton:r,userDetail:n,myPrefix:h,nameTitle:t,Tooltip:C,toggleSubMenuActive:o=>{o.Active=!o.Active}}}}),V={class:"card mb-5 mb-xl-10"},P=e("div",{class:"card-header border-0","data-bs-target":"#kt_account_profile","aria-expanded":"true","aria-controls":"kt_account_profile"},[e("div",{class:"card-title m-0"},[e("h3",{class:"fw-medium m-0"},"\u0E40\u0E1E\u0E34\u0E48\u0E21\u0E15\u0E31\u0E49\u0E07\u0E04\u0E48\u0E32\u0E2A\u0E34\u0E17\u0E18\u0E34\u0E4C")])],-1),L={id:"kt_account_profile"},j={class:"card-body border-top p-9"},z={class:"row mb-6"},G=e("label",{class:"col-lg-4 col-form-label required fw-semobold fs-6"},"\u0E2A\u0E34\u0E17\u0E18\u0E34\u0E4C",-1),H={class:"col-lg-8 fv-row"},O={class:"fv-plugins-message-container"},J={class:"fv-help-block"},K={class:"col-lg-4 col-form-label fw-semobold fs-6"},Q={class:"col-lg-8 fv-row"},W=["name","checked","onChange"],X={class:"col-lg-4 col-form-label fw-semobold fs-6"},Y={class:"card-footer d-flex justify-content-between py-6 px-9"},Z=e("button",{class:"btn btn-danger btn-active-light-second me-2"}," Back ",-1),ee=e("button",{type:"reset",class:"btn btn-secondary btn-active-light-second me-2"}," Discard ",-1),te={type:"submit",id:"kt_account_profile_details_submit",ref:"submitButton",class:"btn btn-success"},se=e("span",{class:"indicator-label"}," Save ",-1),oe=e("span",{class:"indicator-progress"},[N(" Please wait... "),e("span",{class:"spinner-border spinner-border-sm align-middle ms-2"})],-1),ae=[se,oe];function re(t,h,r,n,f,o){const d=m("Field"),s=m("ErrorMessage"),c=m("router-link"),p=m("VForm");return u(),i("div",V,[P,e("div",L,[_(p,{id:"kt_account_profile_form",class:"form",novalidate:"",onSubmit:t.onSubmitSaveChanges,"validation-schema":t.userDetail},{default:E(()=>[e("div",j,[e("div",z,[G,e("div",H,[_(d,{type:"text",name:"UserRule_Name",class:"form-control form-control-lg form-control-solid",placeholder:""}),e("div",O,[e("div",J,[_(s,{name:"UserRule_Name"})])])])]),(u(!0),i(S,null,y(t.menuData,l=>(u(),i("div",{key:l.MainMenu_Id,class:"row mb-6"},[e("label",K,k(l.MainMenu_Name),1),e("div",Q,[(u(!0),i(S,null,y(l.SubMenu,a=>(u(),i("div",{key:a.SubMenu_Id,class:"form-check form-check-solid mt-2"},[e("input",{type:"checkbox",name:"status_"+a.SubMenu_Id,class:"form-check-input",checked:a.Active,onChange:ne=>t.toggleSubMenuActive(a)},null,40,W),e("label",X,k(a.SubMenu_Name),1)]))),128))])]))),128))]),e("div",Y,[e("div",null,[_(c,{to:"/csh_rule_sea"},{default:E(()=>[Z]),_:1})]),e("div",null,[ee,e("button",te,ae,512)])])]),_:1},8,["onSubmit","validation-schema"])])])}const _e=U(T,[["render",re]]);export{_e as default};
