import{ad as V,A as F,ae as _,d as P,C as u,G as A,H as I,af as z,_ as K,r as C,f as k,k as l,p as r,P as j,a2 as q,w as h,l as B,z as U,n as G,F as H,a1 as J,o as R}from"./index.673a3d36.js";import{g as Q}from"./assets.6445f516.js";import{a as W}from"./index.ba5978b4.js";import{S as m}from"./sweetalert2.8ac2e1c4.js";import{D as X}from"./KTDataTable.b434e745.js";const Y=V("UserRules",()=>{const s=F();function a(){s.push({name:"500"})}async function b(){return _.setURL(),_.getAll("csh_rule_sea").then(({data:n})=>n).catch(({data:n})=>{a()})}return{getList:b}}),Z=P({name:"kt-widget-11",components:{Datatable:X},props:{widgetClasses:String,UserAdmin_Name:String},setup(){const s=u([{columnName:"ID",columnLabel:"UserRule_Id"},{columnName:"\u0E2A\u0E34\u0E17\u0E18\u0E34\u0E4C",columnLabel:"UserRule_Name"},{columnName:"Actions",columnLabel:"actions"}]),a=u([]),b=Y(),n=u([]),y=u([]),S=u(!0);A(async()=>{await I.get("http://localhost:3100/api/getProfileApp_By_IdApi").then(async e=>{let i=e.data[0].UserRule_Id;const d="2",f="7",E=!0;await I.get(`http://localhost:3100/api/ListMenuById/${i}`).then(async O=>{const T=O.data[0].MainMenu.find(v=>v.MainMenu_Id===d);if(T){const v=T.SubMenu.find($=>$.SubMenu_Id===f);v&&v.Active===E?await c():z.push("/notPermission")}})}).catch(e=>{console.log(e)})}),A(()=>{});const c=async()=>{n.value=await b.getList(),S.value=!1,y.value=await b.getList()},p=e=>{const t=e.order==="asc";e.label&&W(n.value,e.label,{reverse:t})},w=e=>{a.value=e},o=e=>{m.fire({html:"Are you sure ?",icon:"warning",buttonsStyling:!1,showCancelButton:!0,confirmButtonText:"Ok, delete it!",cancelButtonText:"Cancel",customClass:{confirmButton:"btn btn-dark btn-sm",cancelButton:"btn btn-danger btn-sm"}}).then(async function(t,i){if(t.value){const d={UserRule_Delete:"1"};await I.put(`http://localhost:3100/api/updateUserRules/${e}`,d).then(f=>{m.fire({text:f.data.message,icon:"success",buttonsStyling:!1,confirmButtonText:"Ok, got it!",heightAuto:!1,customClass:{confirmButton:"btn fw-semobold btn-light-primary"}}).then(()=>{c()})}).catch(f=>{m.fire({text:f.response.data.message,icon:"error",buttonsStyling:!1,confirmButtonText:"Try again!",heightAuto:!1,customClass:{confirmButton:"btn fw-semobold btn-light-danger"}})})}else t.dismiss==="cancel"&&a.value})},g=u(""),M=()=>{if(n.value.splice(0,n.value.length,...y.value),g.value!==""){let e=[];for(let t=0;t<n.value.length;t++)x(n.value[t],g.value)&&e.push(n.value[t]);n.value.splice(0,n.value.length,...e)}},x=(e,t)=>{for(let i in e)if(!Number.isInteger(e[i])&&typeof e[i]!="object"&&e[i].indexOf(t)!=-1)return!0;return!1},D=()=>{m.fire({html:"Are you sure ?",icon:"warning",buttonsStyling:!1,showCancelButton:!0,confirmButtonText:"Ok, delete it!",cancelButtonText:"Cancel",customClass:{confirmButton:"btn btn-dark btn-sm",cancelButton:"btn btn-danger btn-sm"}}).then(function(e){if(e.value){let t=[];a.value.forEach(d=>{t.push(d),L(d)}),N("accounts/list/delete",{list:t})}else e.dismiss==="cancel"&&a.value})},L=e=>{for(let t=0;t<n.value.length;t++)n.value[t].UserRule_Id===e&&n.value.splice(t,1)},N=(e,t)=>{_.setURL(),_.deleteSelect(e,t).then(i=>{c(),m.fire({text:i.data.message,icon:"success",buttonsStyling:!1,confirmButtonText:"Ok, got it!",heightAuto:!1,customClass:{confirmButton:"btn fw-semobold btn-light-primary"}})}).catch(i=>{m.fire({text:i.response.data.message,icon:"error",buttonsStyling:!1,confirmButtonText:"Try again!",heightAuto:!1,customClass:{confirmButton:"btn fw-semobold btn-light-danger"}})})};return{loading:S,UserRulesList:n,sort:p,onItemSelect:w,headerConfig:s,deleteButton:o,getAssetPath:Q,search:g,searchItems:M,selectedIds:a,deleteFewSubscriptions:D}}}),ee={class:"card-header border-0 pt-6"},te={class:"card-title"},se={class:"d-flex align-items-center position-relative my-1"},ne={class:"card-toolbar"},ae={key:0,class:"d-flex justify-content-end","data-kt-subscription-table-toolbar":"base"},oe={key:1,class:"d-flex justify-content-end align-items-center"},le={class:"fw-bold me-5"},ie={class:"me-2"},ce={class:"card-body py-3"},re={class:"badge badge-light"},de=["onClick"],ue=J('<div class="modal fade" tabindex="-1" id="kt_modal_1"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><h3 class="modal-title">Modal title</h3><div class="btn btn-icon btn-sm btn-active-light-primary ms-2" data-bs-dismiss="modal" aria-label="Close"><i class="ki-duotone ki-cross fs-1"><span class="path1"></span><span class="path2"></span></i></div></div><div class="modal-body"><p>Modal body text goes here.</p></div><div class="modal-footer"><button type="button" class="btn btn-light" data-bs-dismiss="modal">Close</button><button type="button" class="btn btn-primary">Save changes</button></div></div></div></div>',1);function me(s,a,b,n,y,S){const c=C("KTIcon"),p=C("router-link"),w=C("Datatable");return R(),k(H,null,[l("div",{class:G([s.widgetClasses,"card"])},[l("div",ee,[l("div",te,[l("div",se,[r(c,{"icon-name":"magnifier","icon-class":"fs-1 position-absolute ms-6"}),j(l("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=o=>s.search=o),onInput:a[1]||(a[1]=o=>s.searchItems()),class:"form-control form-control-solid w-250px ps-15",placeholder:"Search"},null,544),[[q,s.search]])])]),l("div",ne,[s.selectedIds.length===0?(R(),k("div",ae,[r(p,{to:"csh_rule_add",class:"btn btn-primary"},{default:h(()=>[r(c,{"icon-name":"plus","icon-class":"fs-2"}),U(" Add ")]),_:1})])):(R(),k("div",oe,[l("div",le,[l("span",ie,B(s.selectedIds.length),1),U("Selected ")]),l("button",{type:"button",class:"btn btn-danger",onClick:a[2]||(a[2]=o=>s.deleteFewSubscriptions())}," Delete Selected ")]))])]),l("div",ce,[r(w,{onOnSort:s.sort,onOnItemsSelect:s.onItemSelect,loading:s.loading,data:s.UserRulesList,header:s.headerConfig,"enable-items-per-page-dropdown":!0,"checkbox-enabled":!1,"checkbox-label":"UserRule_Id"},{UserRule_Id:h(({row:o})=>[l("div",re,B(o.UserRule_Id),1)]),UserRule_Name:h(({row:o})=>[U(B(o.UserRule_Name),1)]),actions:h(({row:o})=>[r(p,{to:"csh_rule_edit/"+o.UserRule_Id,class:"btn btn-icon btn-bg-light btn-active-color-primary btn-sm me-1"},{default:h(()=>[r(c,{"icon-name":"pencil","icon-class":"fs-3"})]),_:2},1032,["to"]),l("a",{onClick:g=>s.deleteButton(o.UserRule_Id),class:"btn btn-icon btn-bg-light btn-active-color-primary btn-sm"},[r(c,{"icon-name":"trash","icon-class":"fs-3"})],8,de)]),_:1},8,["onOnSort","onOnItemsSelect","loading","data","header"])])],2),ue],64)}const _e=K(Z,[["render",me]]);export{_e as default};
