import{d as D,ar as w,as as A,at as R,H as m,af as I,e as v,C as g,G as C,au as x,_ as U,r as p,f as _,k as e,p as b,w as M,o as h,F as E,i as S,l as y,z as B}from"./index.673a3d36.js";import{g as N}from"./assets.6445f516.js";import{a as F}from"./account.de44acad.js";import{M as T}from"./multiselect.901b9aab.js";import{S as k}from"./sweetalert2.8ac2e1c4.js";import{c as $,a as P}from"./object.a5e03688.js";const V=D({name:"user-account-profile",components:{ErrorMessage:w,Field:A,VForm:R,Multiselect:T},data(){return{menuData:[]}},async mounted(){await m.get("http://localhost:3100/api/getProfileApp_By_IdApi").then(async t=>{let n=t.data[0].UserRule_Id;const r="2",d="7",o=!0;await m.get(`http://localhost:3100/api/ListMenuById/${n}`).then(async u=>{const c=u.data[0].MainMenu.find(l=>l.MainMenu_Id===r);if(c){const l=c.SubMenu.find(s=>s.SubMenu_Id===d);if(l&&l.Active===o)try{const s=await m.get("http://localhost:3100/api/ListMenu");this.menuData=s.data,console.log(this.menuData)}catch(s){console.error("Error fetching data:",s)}else I.push("/notPermission")}})}).catch(t=>{console.log(t)})},methods:{async onSubmitSaveChanges(t,f){let n=!0,r="";v();const d={UserRule_Name:t.UserRule_Name,UserRule_Delete:"0"};try{let o;await m.post("http://localhost:3100/api/createUserRules",d).then(a=>{o=a.data.userRule.UserRule_Id}).catch(a=>{console.error("An error occurred:",a),n=!1,r="An error occurred:"+a});const u=[];for(const a of this.menuData)for(const c of a.SubMenu)if(c.Active==!0){const l={UserRule_Id:o,MainMenu_Id:a.MainMenu_Id.toString(),SubMenu_Id:c.SubMenu_Id.toString(),UserRuleDetail_Delete:"0"},s=m.post("http://localhost:3100/api/createUserRulesDetail",l).then(()=>{}).catch(i=>{console.error("An error occurred:",i),n=!1,r="An error occurred: "+i});u.push(s)}await Promise.all(u),(n=!0)?k.fire({text:"Data inserted successfully!",icon:"success",buttonsStyling:!1,confirmButtonText:"Ok, got it!",heightAuto:!1,customClass:{confirmButton:"btn fw-semobold btn-light-primary"}}).then(()=>{this.$router.push("/csh_rule_sea/index")}):k.fire({text:"Error inserting data:"+r,icon:"error",buttonsStyling:!1,confirmButtonText:"Try again!",heightAuto:!1,customClass:{confirmButton:"btn fw-semobold btn-light-danger"}})}catch(o){console.error("Error inserting data:",o)}}},setup(){v(),F();const t=g({}),f=g({}),n=g(null),r=$().shape({UserRule_Name:P().required().label("UserRule_Name")});return C(async()=>{}),{getAssetPath:N,submitButton:n,userDetail:r,myPrefix:f,nameTitle:t,Tooltip:x,toggleSubMenuActive:o=>{o.Active=!o.Active}}}}),q={class:"card mb-5 mb-xl-10"},L=e("div",{class:"card-header border-0","data-bs-target":"#kt_account_profile","aria-expanded":"true","aria-controls":"kt_account_profile"},[e("div",{class:"card-title m-0"},[e("h3",{class:"fw-medium m-0"},"\u0E40\u0E1E\u0E34\u0E48\u0E21\u0E15\u0E31\u0E49\u0E07\u0E04\u0E48\u0E32\u0E2A\u0E34\u0E17\u0E18\u0E34\u0E4C")])],-1),j={id:"kt_account_profile"},z={class:"card-body border-top p-9"},G={class:"row mb-6"},H=e("label",{class:"col-lg-4 col-form-label required fw-semobold fs-6"},"\u0E2A\u0E34\u0E17\u0E18\u0E34\u0E4C",-1),O={class:"col-lg-8 fv-row"},J={class:"fv-plugins-message-container"},K={class:"fv-help-block"},Q={class:"col-lg-4 col-form-label fw-semobold fs-6"},W={class:"col-lg-8 fv-row"},X=["name","checked","onChange"],Y={class:"col-lg-4 col-form-label fw-semobold fs-6"},Z={class:"card-footer d-flex justify-content-between py-6 px-9"},ee=e("button",{class:"btn btn-danger btn-active-light-second me-2"}," Back ",-1),te=e("button",{type:"reset",class:"btn btn-secondary btn-active-light-second me-2"}," Discard ",-1),se={type:"submit",id:"kt_account_profile_details_submit",ref:"submitButton",class:"btn btn-success"},oe=e("span",{class:"indicator-label"}," Save ",-1),ae=e("span",{class:"indicator-progress"},[B(" Please wait... "),e("span",{class:"spinner-border spinner-border-sm align-middle ms-2"})],-1),ne=[oe,ae];function re(t,f,n,r,d,o){const u=p("Field"),a=p("ErrorMessage"),c=p("router-link"),l=p("VForm");return h(),_("div",q,[L,e("div",j,[b(l,{id:"kt_account_profile_form",class:"form",novalidate:"",onSubmit:t.onSubmitSaveChanges,"validation-schema":t.userDetail},{default:M(()=>[e("div",z,[e("div",G,[H,e("div",O,[b(u,{type:"text",name:"UserRule_Name",class:"form-control form-control-lg form-control-solid",placeholder:""}),e("div",J,[e("div",K,[b(a,{name:"UserRule_Name"})])])])]),(h(!0),_(E,null,S(t.menuData,s=>(h(),_("div",{key:s.MainMenu_Id,class:"row mb-6"},[e("label",Q,y(s.MainMenu_Name),1),e("div",W,[(h(!0),_(E,null,S(s.SubMenu,i=>(h(),_("div",{key:i.SubMenu_Id,class:"form-check form-check-solid mt-2"},[e("input",{type:"checkbox",name:"status_"+i.SubMenu_Id,class:"form-check-input",checked:i.Active,onChange:ce=>t.toggleSubMenuActive(i)},null,40,X),e("label",Y,y(i.SubMenu_Name),1)]))),128))])]))),128))]),e("div",Z,[e("div",null,[b(c,{to:"/csh_rule_sea"},{default:M(()=>[ee]),_:1})]),e("div",null,[te,e("button",se,ne,512)])])]),_:1},8,["onSubmit","validation-schema"])])])}const he=U(V,[["render",re]]);export{he as default};
